<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oink-O-Clock Jump Battle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation;
            background: #0f172a;
            margin: 0;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        canvas {
            display: block;
            image-rendering: antialiased;
        }
        .ui-layer { pointer-events: none; }
        .ui-layer button, .ui-layer .clickable { pointer-events: auto; }
        .card-item { cursor: pointer; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden; }
        .card-item:hover:not(.locked) { transform: scale(1.02); background: rgba(255, 255, 255, 0.05); }
        .card-item.selected { border-color: #F472B6; background: rgba(244, 114, 182, 0.15); }
        .toast { animation: slide-in-top 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes slide-in-top { from { transform: translateY(-100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .noir-mode { filter: grayscale(100%) contrast(120%); }
        .vs-pulse { animation: vs-pulse 1s infinite alternate; }
        @keyframes vs-pulse { from { transform: scale(1); opacity: 0.8; } to { transform: scale(1.1); opacity: 1; } }
        .searching-dots::after { content: '...'; animation: dots 1.5s steps(4, end) infinite; }
        @keyframes dots { 0%, 20% { content: ''; } 40% { content: '.'; } 60% { content: '..'; } 80% { content: '...'; } }
        .rainbow-text {
            background: linear-gradient(to right, #f472b6, #60a5fa, #34d399, #fbbf24);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 400% 400%;
            animation: rainbow-scroll 5s ease infinite;
        }
        @keyframes rainbow-scroll { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
    </style>
<script type="importmap">
{
  "imports": {
    "firebase/": "https://esm.sh/firebase@^12.8.0/"
  }
}
</script>
</head>
<body>
    <div id="game-container" class="relative shadow-2xl overflow-hidden border-4 border-indigo-900 rounded-3xl bg-indigo-950" style="width: 400px; height: 700px;">
        <canvas id="gameCanvas" width="400" height="700"></canvas>
        
        <!-- Notifications -->
        <div id="toast-container" class="absolute top-4 left-0 right-0 z-[100] px-4 flex flex-col items-center gap-2 pointer-events-none"></div>

        <!-- Home Screen -->
        <div id="ui-home" class="absolute inset-0 flex flex-col items-center justify-center bg-indigo-950/80 backdrop-blur-sm z-40 text-white p-6 text-center">
            <div id="home-coin-pill" class="absolute top-6 right-6 flex items-center gap-2 bg-black/40 px-3 py-1.5 rounded-full border border-white/5">
                <div class="w-4 h-4 bg-yellow-400 rounded-full flex items-center justify-center text-[10px] text-black font-black">‚Çµ</div>
                <div id="home-coins" class="text-sm font-black">0</div>
            </div>

            <div class="mb-6">
                <h1 class="text-5xl font-black mb-1 tracking-tighter text-pink-400 drop-shadow-lg leading-none">OINK BATTLE</h1>
                <p class="text-pink-300/60 font-bold tracking-widest text-[10px] uppercase">Online Swine Showdown</p>
            </div>
            
            <div class="flex flex-col gap-3 w-64 items-center">
                <button id="btn-battle" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-black py-4 rounded-2xl text-xl transition-all active:scale-95 shadow-xl flex flex-col items-center leading-none">
                    <span>BATTLE ONLINE</span>
                    <span id="firebase-status" class="text-[9px] opacity-60 mt-1 uppercase tracking-tighter">Real-time Versus Mode</span>
                </button>
                <button id="btn-solo" class="w-full bg-pink-500 hover:bg-pink-400 text-white font-black py-3 rounded-2xl text-lg transition-all active:scale-95 shadow-xl uppercase">Solo Practice</button>
                
                <div class="grid grid-cols-3 gap-2 w-full">
                    <button id="btn-skins" class="bg-indigo-800 hover:bg-indigo-700 text-white font-bold py-2 rounded-xl text-[10px] uppercase">SKINS</button>
                    <button id="btn-hats" class="bg-indigo-800 hover:bg-indigo-700 text-white font-bold py-2 rounded-xl text-[10px] uppercase">HATS</button>
                    <button id="btn-themes" class="bg-indigo-800 hover:bg-indigo-700 text-white font-bold py-2 rounded-xl text-[10px] uppercase">THEMES</button>
                </div>
            </div>

            <div class="mt-8 group cursor-pointer" id="btn-username">
                <div id="display-username" class="text-pink-400 font-black text-sm group-hover:underline">Identify Yourself</div>
            </div>
        </div>

        <!-- Matchmaking Overlay -->
        <div id="ui-matchmaking" class="absolute inset-0 flex flex-col items-center justify-center bg-indigo-950/95 z-[60] text-white p-8 text-center hidden">
            <div class="w-24 h-24 mb-6 relative">
                <div class="absolute inset-0 border-4 border-pink-500 border-t-transparent rounded-full animate-spin"></div>
                <div class="absolute inset-0 flex items-center justify-center text-4xl">üê∑</div>
            </div>
            <h2 class="text-2xl font-black mb-2 uppercase italic searching-dots">Finding Opponent</h2>
            <p id="matchmaking-msg" class="text-xs text-white/40 mb-8 max-w-xs">Scanning for other brave piggies in the time stream...</p>
            <button id="btn-cancel-match" class="text-[10px] font-bold text-white/30 hover:text-white uppercase tracking-widest border border-white/10 px-6 py-2 rounded-full">Cancel</button>
        </div>

        <!-- Battle Start Screen -->
        <div id="ui-battle-start" class="absolute inset-0 flex flex-col items-center justify-center bg-indigo-950 z-[70] text-white hidden">
            <div class="flex items-center gap-8 mb-8">
                <div class="flex flex-col items-center">
                    <div class="w-20 h-20 bg-pink-500/20 rounded-2xl border-2 border-pink-500 mb-2 flex items-center justify-center overflow-hidden">
                        <canvas id="p1-preview" width="64" height="64"></canvas>
                    </div>
                    <span id="p1-name" class="font-black text-sm uppercase">YOU</span>
                </div>
                <div class="text-4xl font-black italic text-pink-500 vs-pulse">VS</div>
                <div class="flex flex-col items-center">
                    <div class="w-20 h-20 bg-indigo-500/20 rounded-2xl border-2 border-indigo-500 mb-2 flex items-center justify-center overflow-hidden">
                        <canvas id="p2-preview" width="64" height="64"></canvas>
                    </div>
                    <span id="p2-name" class="font-black text-sm uppercase">RIVAL</span>
                </div>
            </div>
            <h2 id="battle-countdown" class="text-6xl font-black italic">3</h2>
        </div>

        <!-- Popups -->
        <div id="ui-skins" class="absolute inset-0 flex flex-col bg-indigo-950 z-50 text-white p-6 hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-black uppercase italic tracking-tighter">Skins</h2>
                <button id="btn-close-skins" class="bg-white/10 p-2 rounded-full">‚úï</button>
            </div>
            <div id="skins-grid" class="flex-1 overflow-y-auto space-y-2 pr-1"></div>
        </div>

        <div id="ui-hats" class="absolute inset-0 flex flex-col bg-indigo-950 z-50 text-white p-6 hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-black uppercase italic tracking-tighter">Hats</h2>
                <button id="btn-close-hats" class="bg-white/10 p-2 rounded-full">‚úï</button>
            </div>
            <div id="hats-grid" class="flex-1 overflow-y-auto space-y-2 pr-1"></div>
        </div>

        <div id="ui-themes" class="absolute inset-0 flex flex-col bg-indigo-950 z-50 text-white p-6 hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-black uppercase italic tracking-tighter">Themes</h2>
                <button id="btn-close-themes" class="bg-white/10 p-2 rounded-full">‚úï</button>
            </div>
            <div id="themes-grid" class="flex-1 overflow-y-auto space-y-2 pr-1"></div>
        </div>

        <!-- HUD -->
        <div id="ui-hud" class="absolute top-0 left-0 right-0 p-4 flex justify-between ui-layer text-white hidden">
            <div class="bg-black/40 backdrop-blur-md px-4 py-2 rounded-2xl border border-white/5">
                <div class="text-[8px] font-bold uppercase opacity-60 tracking-widest mb-0.5">YOU</div>
                <div id="score-val" class="text-3xl font-black text-pink-400 leading-none">0</div>
            </div>
            <div id="opponent-hud" class="bg-black/40 backdrop-blur-md px-4 py-2 rounded-2xl border border-white/5 text-right hidden">
                <div class="text-[8px] font-bold uppercase opacity-60 tracking-widest mb-0.5">OPPONENT</div>
                <div id="opponent-score-val" class="text-3xl font-black text-indigo-400 leading-none">0</div>
            </div>
        </div>

        <!-- Game Over / Results -->
        <div id="ui-gameover" class="absolute inset-0 flex flex-col items-center justify-center bg-red-950/90 backdrop-blur-md z-[55] text-white p-6 text-center hidden">
            <h2 id="battle-result" class="text-5xl font-black mb-1 uppercase tracking-tighter">YOU LOST!</h2>
            <div class="text-7xl font-black text-pink-400 mb-8" id="final-score">0</div>
            <div class="flex flex-col gap-3 w-64 items-center">
                <button id="btn-go-home" class="bg-white text-indigo-900 font-black py-4 px-12 rounded-xl text-2xl w-full active:scale-95 transition-transform uppercase">HOME</button>
            </div>
        </div>

        <!-- Username Entry -->
        <div id="ui-username" class="absolute inset-0 flex flex-col items-center justify-center bg-indigo-950/95 backdrop-blur-md z-[60] text-white p-6 text-center hidden">
            <h2 class="text-2xl font-black mb-2 uppercase italic">Identify Yourself</h2>
            <input type="text" id="username-input" maxlength="12" placeholder="PIG-NAME" class="w-64 bg-indigo-900 border-2 border-pink-500/30 text-white text-center py-3 rounded-xl font-bold mb-4 focus:outline-none focus:border-pink-500">
            <button id="btn-save-username" class="bg-pink-500 text-white font-black py-3 px-12 rounded-xl text-lg transition-transform active:scale-95 w-64 uppercase">CONFIRM</button>
        </div>
    </div>

    <script type="module" src="index.tsx"></script>
</body>
</html>